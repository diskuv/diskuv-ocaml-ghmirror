## 1.2.1 (@@YYYYMMDD@@)

### Upgrading?

First uninstall the old Diskuv OCaml version using "Add or remove programs" in the Control Panel.

### What do I do after the install is complete?

You SHOULD read the "Install is done! What next?" at <https://diskuv-ocaml.gitlab.io/distributions/dkml/#install-is-done-what-next> documentation.

If you had any existing local switches, upgrade them by doing `dkml init`, `opam upgrade` and `opam install . --deps-only` in the local switch directories.

### Changes

Major changes:

* The deprecated `fdopen` repository is no longer used. Previously DkML used a
  smaller and smaller portion of the `fdopen` repository with each version. Now
  DkML is relies only on the central opam repository and the DkML opam
  repository.
* The set of pinned packages during a `dkml init` local switch has gone down
  from approximately 4000 to 200. Rather than pinning each package in the
  opam universe to a heuristically-determined version, we pin only packages
  that we successfully build on Windows.

Bug fixes:

* The installer can now restart after a failed installation, without having
  to use the uninstaller.
* Allow setup to succeed on Windows filesystems that do not support the setting
  of file attributes
* FlexDLL object files `flexdll_initer_msvc64.obj` and `flexdll_msvc64.obj` (or
  32-bit variant on 32-bit installs) are installed alongside `flexlink.exe` so
  flexlink can be used by itself without setting `FLEXDIR` environment
  variable.
* The auto-installed `dkml` switch now only has `base` and `utop` packages.
  In this and many prior versions other packages had been installed as binaries
  directly to PATH, so other packages in the switch were redundant. Makes the
  compilation install step faster.

Upgraded packages:

| Package         | From              | To          |
| --------------- | ----------------- | ----------- |
| ptime           | 0.8.6-msvcsupport | 1.1.0       |
| base            | v0.15.1           | v0.16.1     |
| sexplib         | v0.15.1           | v0.16.0     |
| stdio           | v0.15.0           | v0.16.0     |
| conf-pkg-config | 2                 | 2+cpkgs (1) |

* (1) `conf-pkg-config.2+cpkgs` downloads a native Windows binary `pkgconf` and
  makes it available to opam as `pkg-config`. *Package maintainers*:
  `pkgconf` supports native Windows slightly better than `pkg-config`. It is
  mostly a drop-in replacement, and `dkml init` (the tool to create switches)
  will set `PKG_CONFIG_PATH` to the location of CLANG64 MSYS2 packages. In a
  future release of DkML after Opam 2.2, CLANG64 MSYS2 packages will be
  installable through depext.

`dkml init` changes:

* The opam switch variable `dkml-abi` is available after running `dkml init`.
  The `dkml-abi` for 64-bit Windows is `windows_x86_64`.
